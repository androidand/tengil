# Tengil Configuration Example (modern Phase 2)
# Copy this to tengil.yml and customize for your setup.
# For an auto-create focused sample, see examples/phase2-auto-create.yml.

# Define one or more ZFS pools
pools:
  # Primary pool
  tank:
    type: zfs
    description: "Main storage pool"
    
    datasets:
      # Media storage
      media:
        profile: media
        zfs:
          recordsize: 1M
          compression: lz4
        containers:
          - name: jellyfin
            mount: /media
            readonly: true
          - name: plex
            mount: /media
            readonly: true
        shares:
          smb:
            name: "Media"
            guest_ok: true
            browseable: true
          nfs:
            allowed: "192.168.1.0/24"
            options: "ro,sync,no_subtree_check"
      
      # Documents
      documents:
        profile: documents
        containers:
          - name: nextcloud
            mount: /documents
        shares:
          smb:
            name: "Documents"
            valid_users: "@users"
      
      # Backups
      backups:
        profile: backups
        zfs:
          compression: zstd
        shares:
          nfs:
            allowed: "192.168.1.0/24"
            options: "rw,sync"

# Application repositories synced into containers
apps:
  repos:
    - name: jellyfin-config
      target: jellyfin
      repo: https://github.com/example/jellyfin-config.git
      path: /srv/apps/jellyfin-config
      manifests:
        glob: "*.app.yml"
        depth: 2

